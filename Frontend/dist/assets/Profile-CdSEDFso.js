import{u as E,r as o,D as j,n as H,p as R,j as t}from"./index-00cI4IgE.js";import{N as O}from"./Navbar-BnSOKXii.js";import{F as T}from"./Footer-CXM-4f4a.js";import{b as V}from"./index-S13ggCBy.js";import{a as v}from"./axiosService-vpQesCrw.js";import{s as h}from"./toaster-KRpCf2CE.js";import{u as U,a as M}from"./uploadImages-Ck5914DG.js";import"./logo-NL4NpGi6.js";import"./setnget-jfIHgayU.js";import"./index-D2ECkgNr.js";import"./index-D-igGuhj.js";import"./iconBase-CrgXBa7-.js";import"./axios-B6xwUs71.js";import"./index-VWaDGczM.js";const L=()=>{const c=E(),[r,p]=o.useState(null),[u,g]=o.useState(null),[f,x]=o.useState(!1),[n,N]=o.useState([]),[s,m]=o.useState({doctorName:"",gender:"",email:"",age:null,department:"",description:"",phoneNumber:"",education:"",tenture:"",wokringHospital:"",status:"pending",imageFile:null,lisenceCertificate:null}),[F,C]=o.useState(null),[P,k]=o.useState(null),[S,y]=o.useState(!1);return o.useEffect(()=>{const d=async()=>{try{const{data:i}=await v.get(j+"/profile"),{doctor:e}=i;m(l=>({...l,doctorName:e==null?void 0:e.doctorName,age:e==null?void 0:e.age,gender:e==null?void 0:e.gender,department:e==null?void 0:e.department,description:e==null?void 0:e.description,education:e==null?void 0:e.education,tenture:e==null?void 0:e.tenture,wokringHospital:e==null?void 0:e.wokringHospital,email:e==null?void 0:e.email,phoneNumber:e==null?void 0:e.phoneNumber,lisenceCertificate:e==null?void 0:e.lisenceCertificate,status:e==null?void 0:e.status})),C((e==null?void 0:e.profileImage)||""),p((e==null?void 0:e.profileImage)||""),k((e==null?void 0:e.lisenceCertificate)||"")}catch(i){console.error("Error fetching profile data:",i),h("Oops! Something went wrong","error")}},a=async()=>{try{const{data:i}=await v.get(j+"/department/list");N(i.departments)}catch(i){console.error("Error fetching departments:",i),h("Oops! Something went wrong while fetching departments","error")}};d(),a()},[]),{profile:r,formData:s,imagePreview:F,certificatePreview:P,error:u,isSubmitting:S,departments:n,handleInputChange:d=>{const{name:a,value:i}=d.target;let e="";if(a==="imageFile"||a==="lisenceCertificate"){const l=d.target,w=l.files&&l.files[0];if(w){const b=new FileReader;b.onloadend=()=>{a==="imageFile"?C(b.result):k(b.result)},b.readAsDataURL(w),m(I=>({...I,[a]:w}))}}else{if(a==="doctorName")i.trim()?H.test(i)||(e="First letter must be capital and no leading or trailing space"):e="Name is required";else if(a==="phoneNumber")i.trim()?R.test(i)||(e="Phone number must have 10 numbers"):e="Phone number is required";else if(a==="tenture"){const l=parseInt(i,10);isNaN(l)||l<0?e="tenture must be a positive number":l>50&&(e="give a valid tenture ")}m(l=>({...l,[a]:a==="age"?parseInt(i,10):i}))}g(e)},handleSubmit:async()=>{if(!u){y(!0);try{const d=await U(s.imageFile),a=await M(s.lisenceCertificate),i=await v.patch(j+"/profile/edit",{doctorName:s.doctorName,gender:s.gender,age:s.age,phoneNumber:s.phoneNumber,department:s.department,education:s.education,tenture:s.tenture,wokringHospital:s.wokringHospital,description:s.description,profileImage:d||(r==null?void 0:r.profileImage),lisenceCertificate:a||(r==null?void 0:r.lisenceCertificate)});h(i.data.message),y(!1),c("/doctor")}catch(d){y(!1),console.error("Error updating profile:",d),h("Oops! Something went wrong while updating profile","error")}}},handleVerify:()=>{x(!0),console.log(f)}}},re=()=>{const{profile:c,formData:r,error:p,imagePreview:u,certificatePreview:g,isSubmitting:f,departments:x,handleInputChange:n,handleSubmit:N}=L();let s="";switch(r==null?void 0:r.status){case"pending":s="Please update the profile with all fields for verification and wait for admin to verify.";break;case"rejected":s="Verification of Doctor Rejected";break;case"approved":s="Verified Doctor";break}return t.jsxs(t.Fragment,{children:[t.jsx(O,{}),t.jsx("div",{className:"bg-gray-100 min-h-screen w-full",children:t.jsxs("div",{className:"container mx-auto px-4 py-10 w-full",children:[t.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-center text-green-700 mb-6",children:"K.Y.C Update"}),t.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 md:p-8 w-full md:w-3/4 mx-auto flex flex-col items-center",children:t.jsxs("div",{className:"bg-white w-full p-4 md:p-6 mb-3 rounded-lg shadow-lg",children:[t.jsx("p",{className:(r==null?void 0:r.status)==="approved"?"text-green-700 font-bold pl-10 pb-4":(r==null?void 0:r.status)==="rejected"?"text-red-600 font-bold pl-10 pb-4":"text-yellow-600 font-bold pl-10 pb-4",children:s}),t.jsxs("div",{className:"flex flex-col md:flex-row items-start mb-6",children:[t.jsx("div",{className:"flex-shrink-0 mb-4 md:mb-0 md:mr-6",children:t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:u||((c==null?void 0:c.profileImage)??"https://picsum.photos/200/"),alt:"Profile",className:"w-24 h-24 md:w-32 md:h-32 rounded-full"}),t.jsx("label",{htmlFor:"profile-image",className:"absolute bottom-0 right-0 bg-white text-black rounded-full cursor-pointer border border-gray-300 p-1",children:t.jsx(V,{})}),t.jsx("input",{type:"file",id:"profile-image",name:"imageFile",className:"hidden",onChange:n})]})}),t.jsx("div",{className:"flex-grow w-full",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"name",className:"block text-gray-700 font-semibold",children:"Name:"}),t.jsx("input",{type:"text",id:"name",name:"doctorName",value:(r==null?void 0:r.doctorName)??"",onChange:n,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-semibold",children:"Email:"}),t.jsx("input",{type:"email",id:"email",name:"email",value:(r==null?void 0:r.email)??"",className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500",disabled:!0})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"phoneNumber",className:"block text-gray-700 font-semibold",children:"Phone Number:"}),t.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:(r==null?void 0:r.phoneNumber)??"",onChange:n,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"department",className:"block text-gray-700 font-semibold",children:"Department:"}),t.jsxs("select",{id:"department",name:"department",value:(r==null?void 0:r.department)??"",onChange:n,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500",children:[t.jsx("option",{className:"text-gray-700",value:""}),x.map(m=>t.jsx("option",{className:"text-gray-700",value:m._id,children:m.departmentName},m._id))]})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"education",className:"block text-gray-700 font-semibold",children:"Education:"}),t.jsx("input",{type:"text",id:"education",name:"education",value:(r==null?void 0:r.education)??"",onChange:n,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"tenture",className:"block text-gray-700 font-semibold",children:"Tenture:"}),t.jsx("input",{type:"text",id:"tenture",name:"tenture",value:(r==null?void 0:r.tenture)??"",onChange:n,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"wokringHospital",className:"block text-gray-700 font-semibold",children:"Working Hospital:"}),t.jsx("input",{type:"text",id:"wokringHospital",name:"wokringHospital",value:(r==null?void 0:r.wokringHospital)??"",onChange:n,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"description",className:"block text-gray-700 font-semibold",children:"Description:"}),t.jsx("input",{id:"description",name:"description",value:(r==null?void 0:r.description)??"",onChange:n,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]})]})})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"lisenceCertificate",className:"block text-gray-700 font-semibold",children:"Doctor License Certificate:"}),t.jsx("input",{type:"file",id:"lisenceCertificate",name:"lisenceCertificate",className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500",onChange:n}),t.jsx("img",{src:g||(c==null?void 0:c.lisenceCertificate),alt:"License Certificate Preview",className:"mt-2 w-48 h-32 object-cover"})]}),p&&t.jsx("p",{className:"text-red-500 mb-4 text-center",children:p})," ",t.jsx("div",{className:"flex justify-center",children:t.jsx("button",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white py-2 px-4 mt-5 rounded-md hover:from-green-600 hover:to-green-800 focus:outline-none focus:ring focus:border-green-500",onClick:N,disabled:f,children:f?"Submitting...":"Update Profile"})})]})})]})}),t.jsx(T,{})]})};export{re as default};
