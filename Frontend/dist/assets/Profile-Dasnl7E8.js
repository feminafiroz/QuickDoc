import{u as E,r as o,D as w,n as H,p as R,j as t}from"./index-C8FnT1Uh.js";import{N as O}from"./Navbar-BX9uRxPu.js";import{F as T}from"./Footer-CPQqGgU1.js";import{b as V}from"./index-DQQWGlg_.js";import{a as v}from"./axiosService-DVz0kc08.js";import{s as h}from"./toaster-DqQ00yAR.js";import{u as U,a as M}from"./uploadImages-DXDQAgHx.js";import"./logo-NL4NpGi6.js";import"./setnget-jfIHgayU.js";import"./index-BykXDHJr.js";import"./index-BZ5afw0P.js";import"./iconBase-tNXNVIyx.js";import"./axios-B6xwUs71.js";import"./index-VWaDGczM.js";const L=()=>{const c=E(),[r,g]=o.useState(null),[u,p]=o.useState(null),[f,x]=o.useState(!1),[a,N]=o.useState([]),[s,m]=o.useState({doctorName:"",gender:"",email:"",age:null,department:"",description:"",phoneNumber:"",education:"",tenture:"",wokringHospital:"",status:"pending",imageFile:null,lisenceCertificate:null}),[F,C]=o.useState(null),[P,k]=o.useState(null),[S,y]=o.useState(!1);return o.useEffect(()=>{const d=async()=>{try{const{data:i}=await v.get(w+"/profile"),{doctor:e}=i;m(l=>({...l,doctorName:e==null?void 0:e.doctorName,age:e==null?void 0:e.age,gender:e==null?void 0:e.gender,department:e==null?void 0:e.department,description:e==null?void 0:e.description,education:e==null?void 0:e.education,tenture:e==null?void 0:e.tenture,wokringHospital:e==null?void 0:e.wokringHospital,email:e==null?void 0:e.email,phoneNumber:e==null?void 0:e.phoneNumber,lisenceCertificate:e==null?void 0:e.lisenceCertificate,status:e==null?void 0:e.status})),C((e==null?void 0:e.profileImage)||""),g((e==null?void 0:e.profileImage)||""),k((e==null?void 0:e.lisenceCertificate)||"")}catch(i){console.error("Error fetching profile data:",i),h("Oops! Something went wrong","error")}},n=async()=>{try{const{data:i}=await v.get(w+"/department/list");N(i.departments)}catch(i){console.error("Error fetching departments:",i),h("Oops! Something went wrong while fetching departments","error")}};d(),n()},[]),{profile:r,formData:s,imagePreview:F,certificatePreview:P,error:u,isSubmitting:S,departments:a,handleInputChange:d=>{const{name:n,value:i}=d.target;let e="";if(n==="imageFile"||n==="lisenceCertificate"){const l=d.target,j=l.files&&l.files[0];if(j){const b=new FileReader;b.onloadend=()=>{n==="imageFile"?C(b.result):k(b.result)},b.readAsDataURL(j),m(I=>({...I,[n]:j}))}}else{if(n==="doctorName")i.trim()?H.test(i)||(e="First letter must be capital and no leading or trailing space"):e="Name is required";else if(n==="phoneNumber")i.trim()?R.test(i)||(e="Phone number must have 10 numbers"):e="Phone number is required";else if(n==="tenture"){const l=parseInt(i,10);isNaN(l)||l<0?e="tenture must be a positive number":l>50&&(e="give a valid tenture ")}m(l=>({...l,[n]:n==="age"?parseInt(i,10):i}))}p(e)},handleSubmit:async()=>{if(!u){y(!0);try{const d=await U(s.imageFile),n=await M(s.lisenceCertificate),i=await v.patch(w+"/profile/edit",{doctorName:s.doctorName,gender:s.gender,age:s.age,phoneNumber:s.phoneNumber,department:s.department,education:s.education,tenture:s.tenture,wokringHospital:s.wokringHospital,description:s.description,profileImage:d||(r==null?void 0:r.profileImage),lisenceCertificate:n||(r==null?void 0:r.lisenceCertificate)});h(i.data.message),y(!1),c("/doctor")}catch(d){y(!1),console.error("Error updating profile:",d),h("Oops! Something went wrong while updating profile","error")}}},handleVerify:()=>{x(!0),console.log(f)}}},re=()=>{const{profile:c,formData:r,error:g,imagePreview:u,certificatePreview:p,isSubmitting:f,departments:x,handleInputChange:a,handleSubmit:N}=L();let s="";switch(r==null?void 0:r.status){case"pending":s="Please update the profile with all fields for verification and wait for admin to verify.";break;case"rejected":s="Verification of Doctor Rejected";break;case"approved":s="Verified Doctor";break}return t.jsxs(t.Fragment,{children:[t.jsx(O,{}),t.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:t.jsxs("div",{className:"flex flex-col items-center w-full max-w-4xl justify-center mb-10 mt-9 bg-gradient-to-r from-green-500 to-green-800 rounded-lg px-7 py-10 shadow-lg text-white relative",children:[t.jsx("h2",{className:"text-4xl font-bold mb-6 text-center",children:"K.Y.C Update"}),t.jsxs("div",{className:"bg-white w-full p-6 mb-3 rounded-lg shadow-lg",children:[t.jsxs("div",{className:"flex items-start mb-6",children:[t.jsx("div",{className:"flex-shrink-0 mr-6",children:t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:u||((c==null?void 0:c.profileImage)??"https://picsum.photos/200/"),alt:"Profile",className:"w-32 h-32 rounded-full"}),t.jsx("label",{htmlFor:"profile-image",className:"absolute bottom-0 right-0 bg-white text-black rounded-full cursor-pointer border border-gray-300 p-1",children:t.jsx(V,{})}),t.jsx("input",{type:"file",id:"profile-image",name:"imageFile",className:"hidden",onChange:a})]})}),t.jsx("div",{className:"flex-grow",children:t.jsxs("div",{className:"md:grid md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"name",className:"block text-gray-700 font-semibold",children:"Name:"}),t.jsx("input",{type:"text",id:"name",name:"doctorName",value:(r==null?void 0:r.doctorName)??"",onChange:a,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-semibold",children:"Email:"}),t.jsx("input",{type:"email",id:"email",name:"email",value:(r==null?void 0:r.email)??"",className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500",disabled:!0})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"phoneNumber",className:"block text-gray-700 font-semibold",children:"Phone Number:"}),t.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:(r==null?void 0:r.phoneNumber)??"",onChange:a,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"department",className:"block text-gray-700 font-semibold",children:"Department:"}),t.jsxs("select",{id:"department",name:"department",value:(r==null?void 0:r.department)??"",onChange:a,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500",children:[t.jsx("option",{className:"text-gray-700",value:""}),x.map(m=>t.jsx("option",{className:"text-gray-700",value:m._id,children:m.departmentName},m._id))]})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"education",className:"block text-gray-700 font-semibold",children:"Education:"}),t.jsx("input",{type:"text",id:"education",name:"education",value:(r==null?void 0:r.education)??"",onChange:a,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"tenture",className:"block text-gray-700 font-semibold",children:"Tenture:"}),t.jsx("input",{type:"text",id:"tenture",name:"tenture",value:(r==null?void 0:r.tenture)??"",onChange:a,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"wokringHospital",className:"block text-gray-700 font-semibold",children:"wokring Hospital:"}),t.jsx("input",{type:"text",id:"wokringHospital",name:"wokringHospital",value:(r==null?void 0:r.wokringHospital)??"",onChange:a,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"description",className:"block text-gray-700 font-semibold",children:"Description:"}),t.jsx("input",{id:"description",name:"description",value:(r==null?void 0:r.description)??"",onChange:a,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500"})]})]})})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"lisenceCertificate",className:"block text-gray-700 font-semibold",children:"Doctor License Certificate:"}),t.jsx("input",{type:"file",id:"lisenceCertificate",name:"lisenceCertificate",className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-green-500",onChange:a}),t.jsx("img",{src:p||(c==null?void 0:c.lisenceCertificate),alt:"License Certificate Preview",className:"mt-2 w-48 h-32 object-cover"})]}),g&&t.jsx("p",{className:"text-red-500 mb-4 text-center",children:g})," ",t.jsx("p",{className:(r==null?void 0:r.status)==="approved"?"text-green-700 font-bold":(r==null?void 0:r.status)==="rejected"?"text-red-600 font-bold":"text-yellow-600 font-bold",children:s}),t.jsx("div",{className:"flex justify-center",children:t.jsx("button",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white py-2 px-4 mt-5 rounded-md hover:from-green-600 hover:to-green-800 focus:outline-none focus:ring focus:border-green-500",onClick:N,disabled:f,children:f?"Submitting...":"Update Profile"})})]})]})}),t.jsx(T,{})]})};export{re as default};
