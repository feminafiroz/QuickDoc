import{f as Z,u as K,b as Q,r as c,j as e,U as f,h as X,i as Y}from"./index-C8FnT1Uh.js";import{F as ee}from"./Footer-DCM7NwJF.js";import{N as te}from"./navbar-CRTHrb3s.js";import{M as se}from"./index-BWzEmu0E.js";import{a as N}from"./axiosService-DVz0kc08.js";import{s as p}from"./toaster-DqQ00yAR.js";import"./index-BykXDHJr.js";import"./index-BZ5afw0P.js";import"./logo-NL4NpGi6.js";import"./setnget-jfIHgayU.js";import"./axios-B6xwUs71.js";import"./index-VWaDGczM.js";const ae=()=>{const w=Z(),T=K(),{id:x}=Q(),[n,P]=c.useState(null),[j,I]=c.useState(""),[R,E]=c.useState({}),[k,F]=c.useState([]),[h,M]=c.useState([]),[v,y]=c.useState(""),[G,S]=c.useState(!1),[i,A]=c.useState(0),[m,$]=c.useState({patientName:"",patientAge:"",patientGender:"",patientNumber:"",patientProblem:""});c.useEffect(()=>{(async()=>{try{const s=await N.get(`${f}/doctor/${x}`);P(s.data.doctor);const o=(await N.get(`${f}/department/list`)).data.departments.filter(a=>a.isListed).reduce((a,l)=>(a[l._id]=l.departmentName,a),{});E(o);try{const l=(await N.get(`${f}/time-slots/${x}/dates`)).data.dateSlots.map(D=>D.date.split("T")[0]),u=new Date().toISOString().split("T")[0],g=l.filter(D=>D>=u),V=Array.from(new Set(g)).sort();M(V)}catch(a){console.error("Error fetching scheduled dates:",a)}}catch(s){console.error("Error fetching doctor n department details:",s)}})()},[x]);const B=()=>{j?S(!0):p("Please select both time slot and package.","error")},O=t=>{const{name:s,value:r}=t.target;$({...m,[s]:r})},b=t=>{const{name:s,value:r}=t.target;$({...m,[s]:r})},q=async()=>{try{const{patientName:t,patientAge:s,patientNumber:r,patientGender:d,patientProblem:o}=m,a=/^[a-zA-Z]+$/,l=/^\d+$/,u=/^\d{10}$/;if(!t||!a.test(t)){p("Please enter a valid name .","error");return}if(!s||!l.test(s)||parseInt(s)<3){p("Please enter a valid age (numeric value, at least 3 years old).","error");return}if(!d){p("Please Select a gender ","error");return}if(!r||!u.test(r)){p("Please enter a valid phone number (10 digits, numbers only).","error");return}if(!o.trim()){p("Please enter the patient's problem.","error");return}const g={doctorId:x||"",doctorName:n.doctorName,doctorImage:n.profileImage,fee:200,paymentStatus:"Pending",appoinmentStatus:"Booked",appoinmentCancelReason:"",timeSlot:j||"",date:v,patientName:t,patientAge:parseInt(s,10),patientGender:d,patientNumber:r,patientProblem:o};w(X()),w(Y(g)),T(`/user/checkout/${n==null?void 0:n._id}`)}catch(t){console.error("Error booking appointment:",t),p("Error booking appointment. Please try again later.","error")}},L=t=>{I(t)},U=t=>{v===t?(y(""),y(t)):(y(t),_(t))},_=async t=>{try{const r=(await N.get(`${f}/time-slots/${x}/dates`,{params:{date:t}})).data.timeSlots,d=new Date,o=new Date(t);o.setHours(0,0,0,0);const a=o.getTime()===new Date().setHours(0,0,0,0);let l=r;a&&(l=r.filter(u=>new Date(`${t} ${u.slotTime}`)>d)),F(l)}catch(s){console.error("Error fetching time slots:",s)}},H=()=>{B()},W=t=>{const s={weekday:"short",day:"numeric",month:"short"},d=new Date(t).toLocaleDateString("en-US",s).toUpperCase(),[o,a,l]=d.split(" ");return{weekday:o,day:l,month:a}},z=()=>{A(Math.max(i-1,0))},J=()=>{A(Math.min(i+1,h.length-6))},C=h.slice(i,i+6);return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Book an Appointment"}),n&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-8",children:[e.jsx("img",{src:n.profileImage,alt:n.doctorName,className:"w-28 h-28 rounded-full mr-4"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:n.doctorName}),R[n==null?void 0:n.department],e.jsx("p",{className:"text-green-600 font-semibold",children:" Fee : â‚¹200 "})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Scheduled Dates"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`cursor-pointer text-2xl ${i===0?"text-gray-400":"text-black"}`,onClick:i!==0?z:void 0,style:{color:i===0?"#A0A0A0":"#000000"},children:"<"}),e.jsx("div",{className:"grid grid-cols-6 gap-4 mx-4",children:C&&C.map((t,s)=>{const{weekday:r,day:d,month:o}=W(t),a=v===t;return e.jsxs("div",{className:`px-8 py-2 rounded-lg shadow-md flex flex-col items-center cursor-pointer ${a?"border-2 border-green-800 bg-green-700 text-white":"bg-white text-gray-600 hover:bg-gray-200"}`,onClick:()=>U(t),children:[e.jsx("input",{type:"radio",id:`dateSlot${s}`,name:"dateSlot",value:t,hidden:!0}),e.jsxs("label",{htmlFor:`dateSlot${s}`,className:"text-center",children:[e.jsx("div",{className:`text-sm ${a?"text-white":"text-gray-500"}`,children:r}),e.jsx("div",{className:`text-2xl font-bold ${a?"text-white":"text-black"}`,children:o}),e.jsx("div",{className:`text-sm ${a?"text-white":"text-gray-500"}`,children:d})]})]},s)})}),e.jsx("div",{className:`cursor-pointer text-2xl ${i===h.length-5?"text-gray-400":"text-black"}`,onClick:i!==h.length-5?J:void 0,style:{color:i===h.length-5?"#A0A0A0":"#000000"},children:">"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Available Time Slots"}),e.jsx("div",{className:"grid grid-cols-9 gap-4",children:k&&k.map((t,s)=>e.jsx("div",{className:`w-full rounded-md py-3 border border-gray-900 px-4 text-sm font-medium ${j===t.slotTime?"bg-green-800 text-white":"bg-white text-gray-600 hover:bg-gray-200"} shadow-md`,onClick:()=>L(t.slotTime),children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:`timeSlot${s}`,className:"text-lg font-bold",children:t.slotTime}),e.jsx("p",{className:t.available?"text-green-700":"text-red-600",children:t.available?"Available":"Not Available"})]})},s))})]}),e.jsx("div",{className:"flex justify-between mb-4",children:e.jsx("button",{onClick:H,className:"bg-green-800 text-white py-2 px-4 rounded-lg",children:"Book an Appointment"})}),e.jsxs(se,{isOpen:G,onRequestClose:()=>S(!1),style:{overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center"},content:{position:"relative",top:"auto",left:"auto",right:"auto",bottom:"auto",width:"90%",maxWidth:"400px",borderRadius:"8px",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",padding:"20px",margin:"0 auto"}},children:[e.jsx("button",{onClick:()=>S(!1),className:"absolute top-0 right-0 m-4 bg-gray-400 p-2 rounded",children:"close"}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Enter Patient Details"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"Name:"}),e.jsx("input",{type:"text",name:"patientName",value:m.patientName,onChange:b,className:"border border-gray-400 rounded-lg px-4 py-2 w-full mt-1"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"Age:"}),e.jsx("input",{type:"text",name:"patientAge",value:m.patientAge,onChange:b,className:"border border-gray-400 rounded-lg px-4 py-2 w-full mt-1"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"Gender:"}),e.jsxs("select",{name:"patientGender",value:m.patientGender,onChange:O,className:"border border-gray-400 rounded-lg px-4 py-2 w-full mt-1",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"others",children:"Others"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"phoneNumber",className:"block mb-2",children:"Phone Number"}),e.jsx("input",{type:"text",required:!0,id:"phoneNumber",name:"patientNumber",value:m.patientNumber,onChange:b,className:"border rounded-lg px-4 py-2 w-full"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"problem",className:"block mb-2",children:"Problem"}),e.jsx("input",{id:"problem",required:!0,name:"patientProblem",value:m.patientProblem,onChange:b,className:"border rounded-lg px-4 py-2 w-full"})]}),e.jsx("button",{onClick:q,className:"bg-green-700 text-white py-2 px-4 rounded-lg",children:"Book Appointment"})]})]})]})},ge=()=>e.jsxs(e.Fragment,{children:[e.jsx(te,{}),e.jsx(ae,{}),e.jsx(ee,{})]});export{ge as default};
